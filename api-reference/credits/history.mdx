---
title: "Histórico de Créditos"
api: "GET /credits/history"
description: "Retorna o histórico de consumo de créditos com agrupamento por período."
auth: "bearer"
---

## Descrição

Este endpoint permite consultar o histórico de consumo de créditos do usuário autenticado, com suporte a filtros por data e agrupamento por fuso horário.

## Autenticação

<ParamField header="Authorization" type="string" required>
  Bearer token do usuário autenticado.
  
  **Formato:** `Bearer {access_token}`
</ParamField>

## Parâmetros de Query

<ParamField query="start_date" type="string">
  Data de início do período (ISO 8601).
  
  **Exemplo:** `2025-01-01T00:00:00.000Z`
  
  **Padrão:** Se não informado, considera 00:00 do dia atual
</ParamField>

<ParamField query="end_date" type="string">
  Data de término do período (ISO 8601).
  
  **Exemplo:** `2025-01-31T23:59:59.999Z`
  
  **Padrão:** Se não informado, considera 23:59 do dia atual
</ParamField>

<ParamField query="timezone" type="string">
  Fuso horário para agrupamento dos dados.
  
  **Exemplo:** `America/Sao_Paulo`
  
  **Padrão:** UTC
</ParamField>

## Resposta de Sucesso

<ResponseField name="data" type="array">
  Array contendo o histórico de consumo agrupado.
  
  <Expandable title="Objeto de Histórico">
    <ResponseField name="date" type="string">
      Data do registro (formato ISO 8601).
    </ResponseField>
    
    <ResponseField name="credits_used" type="number">
      Quantidade de créditos consumidos no período.
    </ResponseField>
    
    <ResponseField name="operation_type" type="string">
      Tipo de operação que consumiu créditos.
    </ResponseField>
    
    <ResponseField name="resource" type="string">
      Recurso utilizado (ex: "smartlinks", "api-calls").
    </ResponseField>
    
    <ResponseField name="count" type="number">
      Número de operações realizadas.
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="summary" type="object">
  Resumo do período.
  
  <Expandable title="Propriedades">
    <ResponseField name="total_credits_used" type="number">
      Total de créditos consumidos no período.
    </ResponseField>
    
    <ResponseField name="period_start" type="string">
      Início do período consultado.
    </ResponseField>
    
    <ResponseField name="period_end" type="string">
      Fim do período consultado.
    </ResponseField>
  </Expandable>
</ResponseField>

## Exemplos de Código

<RequestExample>

```bash cURL
curl --request GET \
  --url 'https://api.monitora.com/credits/history?start_date=2025-01-01&end_date=2025-01-31&timezone=America/Sao_Paulo' \
  --header 'Authorization: Bearer SEU_ACCESS_TOKEN'
```

```javascript JavaScript
const params = new URLSearchParams({
  start_date: '2025-01-01',
  end_date: '2025-01-31',
  timezone: 'America/Sao_Paulo'
});

const response = await fetch(
  `https://api.monitora.com/credits/history?${params}`,
  {
    headers: {
      'Authorization': 'Bearer SEU_ACCESS_TOKEN'
    }
  }
);

const data = await response.json();
```

```python Python
import requests
from datetime import datetime

url = "https://api.monitora.com/credits/history"
headers = {
    "Authorization": "Bearer SEU_ACCESS_TOKEN"
}
params = {
    "start_date": "2025-01-01",
    "end_date": "2025-01-31",
    "timezone": "America/Sao_Paulo"
}

response = requests.get(url, headers=headers, params=params)
print(response.json())
```

</RequestExample>

<ResponseExample>

```json Sucesso (200)
{
  "data": [
    {
      "date": "2025-01-15T00:00:00.000Z",
      "credits_used": 150,
      "operation_type": "validation",
      "resource": "smartlinks",
      "count": 150
    },
    {
      "date": "2025-01-16T00:00:00.000Z",
      "credits_used": 200,
      "operation_type": "validation",
      "resource": "smartlinks",
      "count": 200
    }
  ],
  "summary": {
    "total_credits_used": 350,
    "period_start": "2025-01-01T00:00:00.000Z",
    "period_end": "2025-01-31T23:59:59.999Z"
  }
}
```

</ResponseExample>

## Casos de Uso

<Card title="Análise de Consumo" icon="chart-line">
  Monitore o consumo de créditos ao longo do tempo para identificar padrões de uso.
</Card>

<Card title="Planejamento de Upgrades" icon="arrow-up">
  Use o histórico para decidir quando fazer upgrade do plano baseado no consumo real.
</Card>

<Card title="Auditoria" icon="magnifying-glass">
  Audite o uso de créditos para validação de cobranças e relatórios internos.
</Card>

## Comportamento Padrão

<Info>
  Se nenhuma data for fornecida, o endpoint retorna o consumo do dia atual (00:00 às 23:59).
</Info>

<Tip>
  Use o parâmetro `timezone` para visualizar os dados no fuso horário local, facilitando análises regionais.
</Tip>

## Notas Importantes

<Note>
  O histórico agrupa os dados automaticamente por dia quando o período é maior que 24 horas.
</Note>

<Warning>
  Períodos muito longos podem retornar grandes volumes de dados. Considere paginar ou limitar o período consultado.
</Warning>
